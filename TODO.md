# Task: choSense 2.2 升级 - 个人画像管理与历史记录修复

## Plan
- [x] 步骤1: 创建个人画像管理系统
  - [x] 创建ProfileManagementPanel组件
  - [x] 支持五大学科画像填写（传播学、心理、商业、健康、法律）
  - [x] 支持JSON导入导出
  - [x] 添加个人画像入口按钮
- [x] 步骤2: 添加数据重置功能
  - [x] 在SettingsPanel中添加清空历史记录功能
  - [x] 在SettingsPanel中添加清空画像数据功能
  - [x] 添加确认对话框防止误操作
- [x] 步骤3: 修复历史记录功能
  - [x] 将"历史记录"改名为"历史分析报告"
  - [x] 在分析完成后保存历史记录
  - [x] 包含完整的分析数据（建议、学科记录、时间戳）
  - [x] 修复：无论是否有建议都保存历史记录
- [x] 步骤4: 升级价值评估逻辑
  - [x] 更新AI提示词，传入个人画像
  - [x] 更新AI提示词，传入案例数据库
  - [x] 要求AI综合画像和案例进行价值评估
  - [x] 要求AI匹配相似案例作为参考基准
- [x] 步骤5: 修复画像显示问题
  - [x] 修复画像重复显示bug
  - [x] getAllDisciplineRecords仅从历史中获取
  - [x] 避免当前记录和历史记录重复
- [x] 步骤6: 验证和测试
  - [x] 运行lint检查（已通过）
  - [x] 修复类型错误
  - [x] 修复历史记录保存逻辑
  - [x] 修复画像显示逻辑

## Notes
- 个人画像管理：用户可以主动填写五大学科的个人信息
- 传播学画像：账号名称、粉丝规模、内容类别、受众特征等
- 心理画像：情绪模式、认知特征、信念系统、压力反应
- 商业画像：商业认知、财务素养、变现历史、风险承受
- 健康画像：生活方式、压力水平、健康意识
- 法律画像：法律风险、合规问题、免责声明使用
- 数据重置：支持清空历史记录和画像数据，带确认对话框
- 历史记录：改名为"历史分析报告"，每次分析后自动保存（无论是否有建议）
- 价值评估：AI现在会综合个人画像、AI生成画像、案例数据库进行评估
- 案例匹配：AI会从案例数据库中寻找相似案例作为参考
- 画像显示：修复了重复显示问题，仅从历史中获取记录
- 所有功能已通过lint检查

## 修复的Bug
1. **历史记录不可见**：原因是当没有建议时提前return，不保存历史记录。已修复为无论是否有建议都保存。
2. **画像重复显示**：原因是getAllDisciplineRecords同时包含当前记录和历史记录，但当前记录已被添加到历史中。已修复为仅从历史中获取。
3. **画像更新不可见**：由于重复显示bug导致，修复重复显示后自动解决。

